var search_box_trigger=0;function RefreshStepbox(){var e=$("input:hidden[name = proptyperadio]").val();$("input[name=proptype][value="+e+"]").attr("checked","checked");var a=$("input:hidden[name = bedroomtyperadio]").val();$("input[name=roomnums][value="+a+"]").attr("checked","checked");var n=$("input:hidden[name = amenityradio]").val();$("input[name=amenitytype][value="+n+"]").attr("checked","checked");var i=$("input:hidden[name = sortradio]").val();$("input[name=pricesort][value="+i+"]").attr("checked","checked")}$(document).ready(function(){console.log("ready"),$("#btn_filter").click(function(){0==search_box_trigger?$(".borerstep").slideDown():$(".borerstep").slideUp(),search_box_trigger=1-search_box_trigger;var e=$(".borerstep").width();console.log("step box width:"+e),$(".colfield_2").width(e-70),e<=768&&$(".colfield_s2").width(e-70)}),$("#btn_showmap").click(function(){$("#wrap_map").show(),initialize()}),$(window).click(function(e){console.log("windows click"),"wrap_map"==e.target.id&&$("#wrap_map").hide()}),RefreshStepbox(),addPagination(allprops=$("input:hidden[name = pages]").val()),$("#cpage0").show(),0==gmarkers.length&&($("#container_search").css("width","100%"),$("#container_map").hide());var e=$("#cityname").val(),a="Vacations Abroad is a directory of "+e+" Vacation Rentals and "+e+" Boutique Hotels";$("#footerlogo").attr({title:a,alt:a})});var cur_page=0,allprops=0,min_groupnum=0,max_group=0,cpagenums=0,max_page=1;function addPagination(e){max_page=$("input:hidden[name = pages]").val(),console.log("pages info:pages, properties==>"+max_page+"  "+e),min_groupnum=cur_page,showPagination(cur_page),changedPage()}function showPagination(e){for(max_group=Math.min(max_page,e+10),min_groupnum=e,$("#paging").empty(),$("#paging").append('<span class="pg-normal" onclick="backpage()">«Prev</span>'),i=0;i<max_page;i++)$("#paging").append('|<span class="pg-normal" onclick="getpage('+i+')" id="page'+i+'">'+(i+1)+"</span>");$("#paging").append('|<span class="pg-normal"  onclick="nextpage()"> Next»</span>'),$("#page"+cur_page).addClass("pg-selected")}function getpage(e){cur_page!=e&&(cur_page=e,console.log(min_groupnum+" "+max_group+" "+cur_page),changedPage())}function changedPage(){$(".pagination").find(".pg-selected").removeClass("pg-selected"),$("#page"+cur_page).addClass("pg-selected"),$(".page_hid").hide(),$("#cpage"+cur_page).show()}function backpage(){cur_page>0&&(cur_page--,changedPage())}function nextpage(){cur_page+1<max_page&&(cur_page++,changedPage())}var mainmap,onemap,min_rentaltypes=["None","2 Nights","3 Nights","1 Week","2 Weeks","Monthly","1 Night"],prop_typeval=[8,2,5,16,11,24,2,19,22,12];min_groupnum=0,max_group=0,cpagenums=0;function addOnemaker(e,a,n){for(var i=[[4,6,14],[5,11,19,22,12,13,24],[2,16,8]],o=3,t=0;t<3;t++)if(i[t].indexOf(parseInt(a.categoryid))>-1){o=t;break}var r,p,g=new google.maps.LatLng(a.lat,a.lng),c={url:["http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|154890","http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|6699ff","http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|ff6600","http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|cdbfac"][o],scaledSize:new google.maps.Size(25,40)},l=new google.maps.Marker({position:g,map:e,title:a.description,icon:c,zIndex:100});return r=l,p=a,google.maps.event.addListener(r,"click",function(e){window.open(p.URL)}),l}function addAllmarkers(e){var a=new google.maps.LatLngBounds;for(i=0;i<gmarkers.length;i++){var n=gmarkers[i],o=addOnemaker(e,n,!1);a.extend(o.position),viewd_markers.push(o)}google.maps.event.addListener(e,"zoom_changed",function(){zoomChangeBoundsListener=google.maps.event.addListener(e,"bounds_changed",function(e){this.getZoom()>9&&1==this.initialZoom&&(this.setZoom(9),this.initialZoom=!1),google.maps.event.removeListener(zoomChangeBoundsListener)})}),e.initialZoom=!0,e.fitBounds(a)}function initialize(){mainmap=initializeMap("map_canvas"),reloadMarkers()}function initializeMap(e){console.log("mainmap"+e);var a={center:new google.maps.LatLng(51.5,-.12),zoom:5,mapTypeId:google.maps.MapTypeId.ROADMAP};return new google.maps.Map(document.getElementById(e),a)}function checkInView(e,a){var n=$(".scrollable"),i=n.height(),o=(n.scrollTop(),$(e).offset().top-n.offset().top),t=o+$(e).height(),r=o>=0&&t<=i,p=(o<0&&t>0||o>0&&o<=n.height())&&a;return r||p}function changemapmarker(e){for(var a=$(e).find(".lat_val").val(),n=$(e).find(".long_val").val(),i=0;i<gmarkers.length;i++){var o=gmarkers[i];o.lat==_lat_val&&o.lng==_longi_val&&(viewd_markers[i].setMap(null),viewd_markers[i]=addOnemaker(mainmap,o,!1)),o.lat==a&&o.lng==n&&(viewd_markers[i].setMap(null),viewd_markers[i]=addOnemaker(mainmap,o,!0))}_lat_val=a,_longi_val=n}function reloadMarkers(){for(var e=0;e<viewd_markers.length;e++)viewd_markers[e].setMap(null);viewd_markers=[],addAllmarkers(mainmap)}var _lat_val,_longi_val,lastScrollTop=0,direction=1,viewd_markers=[],_matched_index=0,tmp_index=0;